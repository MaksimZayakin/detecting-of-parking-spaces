# detecting-of-parking-spaces
Применение нейросетей для анализа спутниковых снимков и выявления потенциальных проблем с парковкой транспорта

Парковки:
https://yadi.sk/d/NMyNgO_gJM6DPQ?w=1

Не парковки:
https://yadi.sk/d/6AdVXphb8KQB1g?w=1

Фото для ручного теста сети:
https://yadi.sk/d/5peIXdeyTQgFmA?w=1

Прикрепляю отчет:

## ВВЕДЕНИЕ
  В современных крупных городах и мегаполисах найти место для парковки транспортного средства в центре таких город – это большая проблема. Нехватка парковок так же, как и обилие «пробок» на дорогах сегодня в большинстве Российских мегаполисов входит в тройку наиболее острых проблем. Все дело в том, что города просто не рассчитаны на такое количество автомобилей. Многие владельцы личных автомобилей встречаются с трудностями оставления своих транспортных средств не только в городе, но и около своих домов. Это приводит к многочисленным нарушениям правил дорожного движения, ухода от уплаты за парковочные места и т.д. 
  В связи с вышеизложенным, очевидна актуальность задачи выявления потенциальных проблем с парковкой транспорта. На данный момент существуют различные решения в виде некоторых мобильных приложений. Безусловно эти приложения помогают пользователю с какой-то вероятностью найти парковочное место. Но необходимо более глобально рассматривать эту проблему, для этого предлагается применение методов искусственного интеллекта, а именно – глубокого обучения, оно представляется наиболее перспективным в решении приведенной проблемы. Данный подход обладает явными преимуществами: можно достаточно оперативно и дешево изучать динамику ситуации.
  Таким образом, цель данной работы заключается в разработке, реализации и обучении моделей нейронных сетей для решения двух тесно связанных задач: бинарной классификации спутниковых снимков земной поверхности (на два класса – содержащие парковки и не содержащие) и детектирования искомых объектов – парковок. 

##  Машинное обучение
	В машинном обучении система обучается, а не программируется явно. Ей пере- даются многочисленные примеры, имеющие отношение к решаемой задаче, а она находит в этих примерах статистическую структуру, которая позволяет системе выработать правила для автоматического решения задачи. Например, чтобы автоматизировать задачу определения фотографий, сделанных в отпуске, можно передать системе машинного обучения множество примеров фотографий, уже классифицированных людьми, и система изучит статистические правила классификации конкретных фотографий. 
	Глубокое обучение — это особый раздел машинного обучения: новый подход к по- иску представления данных, делающий упор на изучение последовательных слоев (или уровней) все более значимых представлений. Под глубиной в глубоком обучении не подразумевается более глубокое понимание, достигаемое этим подходом; идея заключается в многослойном представлении. Количество слоев, на которые делится модель данных, называют глубиной модели. Другими подходящими названиями для этой области машинного обучения могли бы служить: многослойное обучение и иерархическое обучение. Современное глубокое обучение часто вовлекает в процесс десятки и даже сотни последовательных слоев представления — и все они автоматически определяются под воздействием обучающих данных. Между тем другие подходы к машинному обучению ориентированы на изучении одного-двух слоев представления данных; по этой причине их иногда называют поверхностным обучением. 
	Keras — это фреймворк поддержки глубокого обучения для Python, обеспечивающий удобный способ создания и обучения практически любых моделей глубокого обучения. Первоначально Keras разрабатывался для исследователей с целью дать им возможность быстро проводить эксперименты. 
Keras обладает следующими ключевыми характеристиками: 
1)позволяет выполнять один и тот же код на CPU или GPU; 
2)имеет дружественный API, упрощающий разработку прототипов моделей глубокого обучения; 
3)включает в себя встроенную поддержку сверточных сетей (для распознавания образов), рекуррентных сетей (для обработки последовательностей) и всевоз- можных их комбинаций; 
4)включает в себя встроенную поддержку сверточных сетей (для распознавания образов), рекуррентных сетей (для обработки последовательностей) и всевоз- можных их комбинаций Тьюринга;  
	Keras — это библиотека уровня модели, предоставляющая высокоуровневые строительные блоки для конструирования моделей глубокого обучения. Она не реализует низкоуровневые операции, такие как манипуляции с тензорами и дифференцирование, — для этого используется специализированная и оптимизированная библиотека поддержки тензоров. При этом Keras не полагается на какую-то одну библиотеку поддержки тензоров, а использует модульный подход; то есть к фреймворку Keras можно подключить несколько разных низкоуровневых библиотек. В настоящее время поддерживаются три такие библиотеки: TensorFlow, Theano и Microsoft Cognitive Toolkit (CNTK). В будущем Keras, скорее всего, будет расширен еще несколькими низкоуровневыми механизмами поддержки глубокого обучения. 

Используя TensorFlow (Theano или CNTK), Keras может выполнять вычисления и на CPU, и на GPU. При выполнении на CPU TensorFlow сама использует низкоуровневую библиотеку специализированных операций с тензорами, которая называется Eigen 
Вот как выглядит типичный процесс использования Keras: 
1)Определяются обучающие данные: входные и целевые тензоры. 
2)Определяются слои сети (модель), отображающие входные данные в целевые. 
3)Настраивается процесс обучения выбором функции потерь, оптимизатора и не- которых параметров для мониторинга. 
4)Выполняются итерации по обучающим данным вызовом метода fit() модели. 
	Модель можно определить двумя способами: с использованием класса Sequential (только для линейного стека слоев — наиболее популярная архитектура сетей в на- стоящее время) или функционального API (для ориентированного ациклического графа слоев, позволяющего конструировать произвольные архитектуры). 

Для решения задачи использовалась модель сверточной сети VGG16, она является одной из самых знаменитых моделей. В ходе решени задачи, взяв готовую нейросеть, мы отбросили полносвязные слои и переобучили часть сверточных слоев, а после добавили свои полносвязные слои.

## Результаты
Для выполнения работы было отобрано 1000 изображений, из которых на 500 содержится парковка, а на остальных 500 нет. Для тренировочной выборки взяли 600 изображений, для тестирования было взято еще 200 изображений и оставшиеся 200 служили для валидации.
Проверочная выборка(validation sample) - выборка, по которой осуществляется выбор наилучшей модели из множества, построенных по обучающей выборке.
В результате переобучения нейронной сети получили точность определения 93% 

Изображения:
https://drive.google.com/drive/folders/1bQ1dsrsPy9bVR0zB0LrZVUlM72J8_2n4

## Ручное тестирование
В ходе работы была получена модель нейронной сети с расширение h5. Для использования и проверки был написан код, позволяющий получить ответ на вопрос: есть ли на картинке расрешением 256x256 парковка? 
Испытания проводились на 10 картинках без парковок и 10 каркантинках с парковками:
+ Картинки без парковок
 1. 1*10^-6  
 2. 2*10^-11
 3. 3*10^-16
 4. 2*10^-15
 5. 2*10^-8
 6. 4*10^-9
 7. 1*10^-13
 8. 3*10^-16
 9. 6*10^-7
 10. 3*10^-12
+ Картинки с парковками
 1. 1 
 2. 1
 3. 7*10^-13 - ошибка
 4. 1
 5. 0.015 - ошибка
 6. 1
 7. 1
 8. 0.99
 9. 1
 10. 0.99

В резльтате проведения ручного тестирования была получена точность определения 18/20 => 90%
